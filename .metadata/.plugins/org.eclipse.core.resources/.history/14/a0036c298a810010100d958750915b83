/* crc32.c: polynomial 0xEDB88320 (reflected), initial ~0, final ~ */
#include "boot.h"

uint32_t crc32_update(uint32_t crc, const uint8_t *data, size_t len){
    crc = ~crc;
    while(len--){
        crc ^= *data++;
        for(int i=0;i<8;i++){
            uint32_t mask = -(crc & 1u);
            crc = (crc >> 1) ^ (0xEDB88320u & mask);
        }
    }
    return ~crc;
}
